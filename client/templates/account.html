<template name="account">
	{{#if currentUser}}
		<h2>{{i18n "account.title"}}</h2>
	{{/if}}
	<div class="row">
		{{#if currentUser}}
			<div class="col-md-8">
				{{> account_exerciseList title=(i18n "account.solvedExercisesSubtitle") exercises=(transformResults results) isResult=true}}
				{{> account_exerciseList title=(i18n "account.createdExercisesSubtitle") exercises=createdExercises}}
				{{> account_exerciseList title=(i18n "account.archivedExercisesSubtitle") exercises=archivedExercises isArchive=true}}
			</div>
			<div class="col-md-4">
				<section class="well form-horizontal">
					<h3>{{i18n "account.accountSettingsSubtitle"}}</h3>
					<div class="form-group">
						<label for="input-email" class="col-md-3 control-label">{{i18n "account.emailLabel"}}</label>
						<div class="col-md-9">
							<input type="email" class="form-control" id="input-email" value="{{currentUserEmail}}" readonly>
						</div>
					</div>
					<div class="form-group">
						<label for="input-name" class="col-md-3 control-label">{{i18n "account.nameLabel"}}</label>
						<div class="col-md-9">
							<input type="text" class="form-control" id="input-name" value="{{currentUserName}}">
						</div>
					</div>
					<div class="form-group">
						<div class="col-md-9 col-md-offset-3">
							<div class="btn-group btn-group-sm separated-bottom">
								<button id="button-logout" class="btn btn-success">{{i18n "account.logoutButton"}}</button>
								<button id="button-logout-others" class="btn btn-primary">{{i18n "account.logoutOtherClientsButton"}}</button>
							</div>
						</div>
					</div>
				</section>
			</div>
		{{else}}
			<div class="col-sm-offset-1 col-sm-10 col-md-offset-2 col-md-8 col-lg-offset-3 col-lg-6">
				{{> atForm}}
			</div>
		{{/if}}
	</div>
</template>
<template name="account_exerciseList">
	<section class="panel panel-default">
		<div class="panel-heading">
			{{#unless isArchive}}
				<h3 class="panel-title">{{title}}</h3>
			{{else}}
				<h3 class="panel-title">
					<a role="button" data-toggle="collapse" href="#collapseArchive"><span class="glyphicon glyphicon-plus-sign"></span></a>
					<a role="button" data-toggle="collapse" href="#collapseArchive">{{title}}</a>
				</h3>
			{{/unless}}
		</div>
		<div id="{{#if isArchive}}collapseArchive{{/if}}" class="{{#if isArchive}}panel-collapse collapse{{/if}}">
			<table class="table table-condensed table-striped">
				<thead>
					<tr>
						<th scope="col">{{i18n "exercise.nameLabel"}}</th>
						<th scope="col">{{i18n "exercise.typeLabel"}}</th>
						<th scope="col">{{i18n "exercise.programmingLanguageLabel"}}</th>
						<th scope="col">{{i18n "exercise.categoryLabel"}}</th>
						<th scope="col">{{i18n "exercise.difficultyLabel"}}</th>
						{{#if isResult}}
							<th scope="col">{{i18n "exercise.solvedLabel"}} <span class="glyphicon glyphicon-chevron-down"></span></th>
						{{else}}
							<th scope="col">{{i18n "form.editedByLabel"}}</th>
							<th scope="col">{{i18n "form.editedAtLabel"}} <span class="glyphicon glyphicon-chevron-down"></span></th>
							<th></th>
						{{/if}}
					</tr>
				</thead>
				<tbody>
					{{#each exercises}}
						<tr>
							<td>
								{{#unless result}}
									{{#linkTo route="exerciseSolve" data=this}}{{i18nName this}}{{/linkTo}}
								{{else}}
									{{#linkTo route="resultView" data=result}}{{i18nName this}}{{/linkTo}}
									{{#if evaluated this result.results}}
										<span class="glyphicon {{#if success this result.results}}glyphicon-ok text-success{{else}}glyphicon-remove text-danger{{/if}}"></span>
									{{else}}
										<span class="glyphicon glyphicon-pencil text-info"></span>
									{{/if}}
								{{/unless}}
							</td>
							<td>{{i18nExerciseType type}}</td>
							<td>{{i18nProgrammingLanguage programmingLanguage}}</td>
							<td>{{i18nName category}}</td>
							<td>{{i18nDifficulty difficulty}}</td>
							{{#if result}}
								<td>{{i18nDateTime result.solved}}</td>
							{{else}}
								<td>{{userName lastEditor_id}}</td>
								<td>{{i18nDateTime lastEdited}}</td>
								{{#unless archived}}
									<td><a role="button" class="a-archive" data-id="{{this._id}}"><span class="glyphicon glyphicon-briefcase" title="{{i18n "exercise.archiveButton"}}" data-toggle="tooltip"></span></a></td>
								{{else}}
									<td><a role="button" class="a-unarchive" data-id="{{this._id}}"><span class="glyphicon glyphicon-briefcase" title="{{i18n "exercise.unarchiveButton"}}" data-toggle="tooltip"></span></a></td>
								{{/unless}}
							{{/if}}
						</tr>
					{{else}}
						<tr>
							<td colspan="{{#if result}}6{{else}}8{{/if}}" class="text-muted">{{i18n "form.noResultsMessage"}}</td>
						</tr>
					{{/each}}
				</tbody>
			</table>
		</div>
	</section>
</template>
